# 사용자 가이드 (User Guide)

이 문서는 Momentum ETF 시스템의 설치, 설정, 실행 방법을 설명합니다.

## 1. 설치 및 실행

### 필수 요구사항
*   Python 3.9 이상
*   Docker (선택 사항, 배포 시 필요)

### 실행 명령어

**1. 튜닝 (최적 파라미터 탐색)**
최적의 파라미터를 찾기 위해 튜닝을 수행합니다. 완료 후 전략 설정이 **자동으로 업데이트**됩니다.
```bash
python tune.py kor_us  # kor_us 계정 튜닝
python tune.py us      # us 계정 튜닝
```

**2. 백테스트 실행**
과거 데이터를 바탕으로 전략의 성과를 시뮬레이션합니다.
```bash
python backtest.py kor_us
python backtest.py us
```

**3. 추천 실행 (매일 아침)**
백테스트 엔진을 기반으로 현재 시점의 매매 추천 목록을 생성하고 Slack으로 알림을 보냅니다.
```bash
python recommend.py kor_us
python recommend.py us
```

## 2. 설정 가이드

### 기본 설정 (`config.py`)
시스템 전반에 걸친 기본 설정을 변경할 수 있습니다.
*   `SLACK_WEBHOOK_URL`: 알림을 받을 슬랙 웹훅 주소


### 계좌별 전략 설정 (`zaccounts` 폴더 내 `config.json`)
각 계좌(포트폴리오)별로 구체적인 전략 파라미터를 설정합니다. `tune.py` 실행 시 자동으로 업데이트됩니다.

**5버킷 포트폴리오 설정 예시:**

```json
{
  "strategy": {
    "MA_MONTH": 12,                    // 이동평균 기간 (개월) - 필수
    "MA_TYPE": "EMA",                  // 이동평균 종류 (SMA, EMA, WMA 등) - 필수
    "BUCKET_TOPN": 1,                  // 버켓 내 최대 보유 종목 수 - 필수
    "REBALANCE_MODE": "QUARTERLY",     // 리밸런싱 주기 (DAILY, WEEKLY, TWICE_A_MONTH, MONTHLY, QUARTERLY) - 필수
    "BACKTEST_LAST_MONTHS": 12         // 백테스트/튜닝 대상 과거 개월 수
  }
}
```

> **주의**: 시스템은 엄격한 설정 표준을 따릅니다. 필수 파라미터(`MA_TYPE`, `REBALANCE_MODE` 등)가 하나라도 누락되면 백테스트 및 리포트 생성이 중단됩니다.

> **5버킷(Bucket) 시스템**:
> 1. **모멘텀**: 공격적인 추세 추종
> 2. **혁신기술**: 성장성이 높은 기술주
> 3. **시장지수**: 안정적인 시장 대표 지수
> 4. **배당방어**: 하락장을 방어하는 배당주
> 5. **대체헷지**: 원자재, 채권 등 주식 외 자산

## 3. 대시보드 및 계좌 관리

### 대시보드 구성
대시보드는 **[요약(Summary)]** 탭과 **[상세(Details)]** 탭으로 나뉩니다.
*   **요약 탭**: 포트폴리오의 전체 수익률, 원금 대비 순이익, 현금 비중 등 핵심 지표를 확인합니다. 버킷별 투자 비중 테이블이 제공됩니다.
*   **상세 탭**: 개별 종목의 현재가, 평가손익, 매매 신호(BUY/SELL/HOLD 등)를 상세히 분석합니다.

### 계좌 관리 (원금 및 현금)
사이드바의 **[계좌 관리]** 메뉴를 통해 각 계좌의 기초 데이터를 수정할 수 있습니다.
*   **💵 원금 및 현금 관리**: 각 계좌의 '총 투자 원금'과 '남은 현금 잔고'를 입력합니다.
*   입력된 데이터는 실시간으로 대시보드의 **총자산 및 수익률 계산**에 반영됩니다.

### 캐시 알림 (Alerts)
대시보드 상단에는 가격 데이터의 최신 정합성을 체크하는 경고창이 뜹니다.
*   **계좌별 그룹화**: 어떤 계좌의 종목이 갱신이 필요한지 계좌별로 친절하게 안내합니다.
*   해당 경고가 뜨면 `python scripts/update_price_cache.py`를 실행하여 데이터를 갱신하십시오.

## 4. 결과 해석

### Slack 알림
매일 아침 전송되는 슬랙 메시지는 다음 정보를 포함합니다.
*   **매매 신호**: 오늘 사고 팔아야 할 종목 (BUY, SELL) - (볼드체 및 색상 원으로 가독성 강화)
*   **보유 현황**: 현재 보유 중인 종목의 상태 및 **연속 보유일** 정보
*   **계좌 요약**: 현재 총 자산, 현금 비중, **평균 수익률** 등


### 로그 파일
실행 중 발생하는 상세 로그는 `logs/` 폴더에 저장됩니다. 오류 발생 시 이 파일을 확인하세요.
