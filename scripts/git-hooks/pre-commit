#!/bin/sh
set -euo pipefail

# Ensure APP_VERSION_TIME is stamped before committing.
REPO_ROOT="$(git rev-parse --show-toplevel)"
STAMP_SCRIPT="$REPO_ROOT/scripts/stamp_app_version_time.py"

if [ ! -x "$STAMP_SCRIPT" ]; then
  echo "stamp_app_version_time.py not executable" >&2
  exit 1
fi

python3 "$STAMP_SCRIPT" --settings "$REPO_ROOT/settings.py"

git add "$REPO_ROOT/settings.py"
